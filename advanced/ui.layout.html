<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Declarative layouts - Avendish documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <div class="sidebar-scrollbox"></div>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <script async src="../toc.js"></script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Avendish documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="layout-based-uis"><a class="header" href="#layout-based-uis">Layout-based UIs</a></h1>
<blockquote>
<p>Supported bindings: ossia, others are work-in-progress</p>
</blockquote>
<p>To define a custom UI, one has to add a <code>struct ui</code> in the processor definition.</p>
<pre><code class="language-cpp">struct MyProcessor {
  struct ui {
   
  };
};
</code></pre>
<p>By default, this will do nothing: we have to fill it. <code>ui</code> will be the top-level widget.
Child widgets can be added simply by defining struct members.
Containers are defined by adding a <code>layout()</code> function which returns an enum value, which may
currently be any of the following names:</p>
<pre><code>hbox,
vbox,
container,
group,
split,
tabs,
grid,
spacing,
control,
custom
</code></pre>
<p>For instance:</p>
<pre><code class="language-cpp">struct ui
{
  static constexpr auto layout() { enum { hbox } d{}; return d; }
  struct {
    static constexpr auto layout() { enum { vbox } d{}; return d; }
    const char* text = "text";
    decltype(&amp;ins::int_ctl) int_widget = &amp;ins::int_ctl;
  } widgets;

  struct {
    static constexpr auto layout() { enum { spacing } d{}; return d; }
    static constexpr auto width() { return 20; }
    static constexpr auto height() { return 20; }
  } a_spacing;

  const char* text = "text2";
};
</code></pre>
<p>This defines, conceptually, the following layout:</p>
<pre><code class="language-ascii">|-----------------------------|
|  |  text  |                 |
|  |        |                 |
|  | =widg= |  &lt;20px&gt;  text2  |
|  |        |                 |
|  |        |                 |
|-----------------------------|
</code></pre>
<h2 id="layouts"><a class="header" href="#layouts">Layouts</a></h2>
<h3 id="hbox-vbox"><a class="header" href="#hbox-vbox">HBox, VBox</a></h3>
<p>These will layout things either horizontally or vertically.</p>
<h3 id="split"><a class="header" href="#split">Split</a></h3>
<p>Each children will be separated by a split line (thus generally one would use it to separate layouts).</p>
<h3 id="grid"><a class="header" href="#grid">Grid</a></h3>
<p>This will layout children items in a grid.</p>
<p>Either of <code>rows()</code> and <code>columns()</code> properties can be defined, but not both:</p>
<pre><code>static constexpr auto rows() { return 3; }
static constexpr auto columns() { return 3; }
</code></pre>
<p>If <code>columns()</code> is defined, children widget will be laid out in the first row until the column count is reached, then in the second row, etc. until there are no more children items, and conversely if <code>rows()</code> is defined.</p>
<p>That is, given:</p>
<pre><code class="language-cpp">struct {
  static constexpr auto layout() { enum { grid } d{}; return d; }
  static constexpr auto columns() { return 3; }
  const char* text1 = "A";
  const char* text2 = "B";
  const char* text3 = "C";
  const char* text4 = "D";
  const char* text5 = "E";
} a_grid;
</code></pre>
<p>The layout will be:</p>
<pre><code class="language-ascii">|---------|
| A  B  C | 
| D  E    |
|---------|
</code></pre>
<p>Instead, if <code>rows()</code> is defined to 3:</p>
<pre><code class="language-ascii">|------|
| A  D | 
| B  E | 
| C    |
|------|
</code></pre>
<h3 id="tabs"><a class="header" href="#tabs">Tabs</a></h3>
<p>Tabs will display children items in tabs.
Each children item should have a <code>name()</code> property which will be shown in the tab bar.</p>
<pre><code class="language-cpp">struct {
  static constexpr auto layout() { enum { tabs } d{}; return d; }
  struct {
    static constexpr auto layout() { enum { hbox } d{}; return d; }
    static constexpr auto name() { return "First tab"; }
    const char* text1 = "A";
    const char* text2 = "B";
  } a_hbox;
  struct {
    static constexpr auto layout() { enum { hbox } d{}; return d; }
    static constexpr auto name() { return "Second tab"; }
    const char* text3 = "C";
    const char* text4 = "D";
  } a_vbox;
} a_tabs;
</code></pre>
<h2 id="properties"><a class="header" href="#properties">Properties</a></h2>
<h3 id="background-color"><a class="header" href="#background-color">Background color</a></h3>
<p>Background colors can be chosen from a standardized set: for now, those are fairly abstract to allow things to work in a variety of environments.</p>
<pre><code>darker,
dark,
mid,
light,
lighter
</code></pre>
<p>Setting the color is done by adding this to a layout:</p>
<pre><code class="language-cpp">static constexpr auto background() { enum { dark } d{}; return d; }
</code></pre>
<h3 id="explicit-positioning"><a class="header" href="#explicit-positioning">Explicit positioning</a></h3>
<p>In "group" or "container" layouts, widgets will not be positioned automatically. <code>x</code> and <code>y</code> methods can be used for that.</p>
<pre><code class="language-cpp">static constexpr auto x() { return 20; }
static constexpr auto y() { return 20; }
</code></pre>
<h3 id="explicit-sizing"><a class="header" href="#explicit-sizing">Explicit sizing</a></h3>
<p>Containers can be given an explicit (device independent) pixel size with</p>
<pre><code class="language-cpp">static constexpr auto width() { return 100; }
static constexpr auto height() { return 50; }
</code></pre>
<p>Otherwise, things will be made to fit in a best-effort way.</p>
<h2 id="items"><a class="header" href="#items">Items</a></h2>
<h2 id="text-labels"><a class="header" href="#text-labels">Text labels</a></h2>
<p>The simplest item is the text label: simply adding a <code>const char*</code> member is sufficient.</p>
<h2 id="controls"><a class="header" href="#controls">Controls</a></h2>
<p>One can add a control (either input or output) simply by adding a member pointer to it:</p>
<pre><code class="language-cpp">struct MyProcessor {
  struct ins {
    halp::hslider_f32&lt;"Foo"&gt; foo;
  } inputs;

  struct ui
  {
    static constexpr auto layout() { enum { hbox } d{}; return d; }
    const char* text = "text";
    decltype(&amp;ins::foo) int_widget = &amp;ins::foo;
  };
};
</code></pre>
<p>The syntax without helpers currently needs some repeating as C++ does not yet allow <code>auto</code> as member fields, otherwise it'd just be:</p>
<pre><code class="language-cpp">auto int_widget = &amp;ins::foo;
</code></pre>
<h1 id="helpers"><a class="header" href="#helpers">Helpers</a></h1>
<p>Helpers simplify common tasks ; here, C++20 designated-initializers allow us to have a very pretty API and reduce repetitions:</p>
<h2 id="widget-helpers"><a class="header" href="#widget-helpers">Widget helpers</a></h2>
<pre><code class="language-cpp">halp::label l1{
    .text = "some long foo"
  , .x = 100
  , .y = 25
};

halp::item&lt;&amp;ins::foo&gt; widget{
    .x = 75
  , .y = 50
};
</code></pre>
<h2 id="properties-helpers"><a class="header" href="#properties-helpers">Properties helpers</a></h2>
<pre><code class="language-cpp">struct ui {
 // If your compiler is recent enough you can do this, 
 // otherwise layout and background enums have to be qualified:
 using enum halp::colors;
 using enum halp::layouts;
 
 halp_meta(name, "Main")
 halp_meta(layout, hbox)
 halp_meta(background, mid)

 struct {
   halp_meta(name, "Widget")
   halp_meta(layout, vbox)
   halp_meta(background, dark)
   halp::item&lt;&amp;ins::int_ctl&gt; widget;
   halp::item&lt;&amp;outs::measure&gt; widget2;
 } widgets;
};
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../advanced/ui.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../advanced/ui.painting.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../advanced/ui.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../advanced/ui.painting.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
